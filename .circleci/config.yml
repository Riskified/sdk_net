version: 2

jobs:
  build:
    docker:
      - image: cimg/base:2021.04
    working_directory: ~/RiskifiedSDK
    steps:
      - checkout
      #- run: 
       #   name: "Downloads the package lists from the repository"
        #  command: sudo apt-get update
      
      - run: # print the name of the branch we're on
          name: "what version am I using "
          command: echo dotnet --version
      - run: 
          name: "Install Nuget, Mono-devel and Mono-XBuild"
          command: sudo apt-get install -y nuget mono-devel mono-xbuild
      - run: 
          name: "Updating Nuget to most recent version"
          command: sudo nuget update -self
      - run: 
          name: "Downloading project dependencies"
          command: nuget restore SDK_NET.sln
      - run: 
          name: "Mono version"
          command: mono --version
      - run: 
          name: "Build and release binaries"
          command: xbuild SDK_NET.sln
          #command: xbuild /p:Configuration=Release SDK_NET.sln

      - run: cd Riskified.SDK
      - run: ls
      - run: 
          name: "Nuget pack"
          command: nuget pack ~/RiskifiedSDK/Riskified.SDK/Riskified.SDK.csproj
      - run: 
          command: ls
    
workflows:
  version: 2
  build_and_deploy:
    jobs:
      - build:
          filters: 
            branches:
              only: TIS-361
